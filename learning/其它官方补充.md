- [可复用性&组合](#可复用性&组合)
  + [混入](#混入)
    - [混入规则](#混入规则)
    - [全局引用_混入](#全局引用_混入)
  + [自定义指令](#自定义指令)
    - [自定义指令实现自动聚焦](#自定义指令实现自动聚焦)
    - [钩子函数](#钩子函数)
    - [钩子函数参数](#钩子函数参数)
    - [动态指令参数](#动态指令参数)
    - [函数简写](#函数简写)
    - [对象字面量](#对象字面量)

#### 单文件组件  
> 使用 `.vue` 的单文件组件，可以解决全局定义的问题、实现高亮语法、预处理器等。  
> 
> 在一个组件里，其模板、逻辑和样式是内部耦合的，这样搭配使得组件更加内聚且更可维护。

```
// 组件作用域的 CSS
<style scoped>
...
</style>
```

#### 配置相关  

- 实现脚手架外的自定义[配置项](https://cli.vuejs.org/zh/config/)  
- [手动配置](https://vue-loader.vuejs.org/zh/) webpack 搭建构造工具  
- 更多的 [webpack](https://webpack.js.org/configuration/) [内容](https://www.webpackjs.com/concepts/)

#### 生产环境  
> 此时不需要 Vue 提供的警告语句，可以使用[压缩版](https://vuejs.bootcss.com/guide/installation.html#直接用-lt-script-gt-引入)来减少体积。  
> 
> 可以使用 `process.env.NODE_ENV` 检测环境来去除仅开发环境使用的代码。  

#### [混入](https://github.com/SpringLoach/Vue/blob/main/learning/section4.md#混入的简单使用)规则   
> 当组件和混入对象含有同名选项时的合并规则。  

对象 | 冲突规则 | 栗子
:-: | :-: | :-: 
数据对象 | 以组件数据优先 | data
钩子函数 | 混入对象的先调用 | created
其它对象 | 以组件的优先 | method

#### 全局引用_混入  
> 只应当应用于自定义选项。  
> 
> 谨慎使用全局混入。推荐将其作为插件发布，避免重复应用混入。  

#### 自定义指令实现自动聚焦  

全局注册
```
// 注册一个全局自定义指令 `v-focus`
Vue.directive('focus', {
  // 当被绑定的元素插入到 DOM 中时……
  inserted: function (el) {
    // 聚焦元素
    el.focus()
  }
})
```

也可以局部注册
```
/* 组件选项 */
directives: {
  focus: {
    // 指令的定义
    inserted: function (el) {
      el.focus()
    }
  }
}
```

使用  
```
<input v-focus>
```

#### 钩子函数  
> 指令定义对象可以提供如下几个钩子函数。  

可选 | 说明 
:-: | :-: 
bind | （调用一次）指令第一次绑定到元素时调用 
inserted | 被绑定元素插入父节点时调用（可能未插入文档）
update | 所在组件的 VNode 更新时调用 
componentUpdated | 所在组件及其子的 VNode 更新后调用 
unbind | （调用一次）指令与元素解绑时调用

#### 钩子函数参数  

参数 | 说明 | 性质
:-: | :-: | :-: 
el | 指令所绑定的元素 | 可直接操作 DOM
binding | [对象](https://vuejs.bootcss.com/guide/custom-directive.html#钩子函数参数) | 只读
vnode | Vue 编译生成的[虚拟节点](https://github.com/vuejs/vue/blob/dev/src/core/vdom/vnode.js) | 只读
oldVnode | 上一个虚拟节点（仅用于两个更新钩子） | 只读

#### 动态指令参数  
> 指令的参数可以是动态的，这时它根据组件实例数据进行更新。  

```
<p v-pin:[direction]="200">占位</p>

directives: {
  pin: {
    bind: function (el, binding, vnode) {
      el.style.position = 'fixed'
      // 获取组件实例参数
      var s = (binding.arg == 'left' ? 'left' : 'top')
      // 获取组件实例绑定值
      el.style[s] = binding.value + 'px'
    }
  }
}
data: function () {
  return {
    direction: 'left'
  }
}
```

#### 函数简写  
> 想在 `bind` 和 `update` 时触发相同行为，而不关心其它的钩子。
> 
> 只需将对应的值由对象改为函数。  

```
directives: {
  pin: function (el, binding, vnode) {...}
}
```

#### 对象字面量  
> 如果指令需要多个值，可以传入对象形式的绑定值。  

```
<div v-demo="{ color: 'white', text: 'hello!' }"></div>

...
console.log(binding.value.color)
console.log(binding.value.text)
```

### 插件  
> 插件通常用来为 Vue 添加全局功能。  

索引 | 方式
:-: | :-: 
Ⅰ | 添加全局方法或者 property 
Ⅱ | 添加全局资源：指令/过滤器/过渡等 
Ⅲ | 通过全局混入来添加一些[组件选项](#自定义指令实现自动聚焦)
Ⅳ | 添加 Vue 实例方法，通过添加到 `Vue.prototype`
Ⅴ | 库，提供自己的 API，实现多种方式

#### 使用插件  
> 需要引入 Vue 和插件，并在创建 Vue 实例**前**安装插件。  

```
// 调用 `MyPlugin.install(Vue)`
Vue.use(MyPlugin)

// 也可以传入一个可选的选项对象
Vue.use(MyPlugin2, { someOption: true })
```

#### 官方插件
> 官方提供的插件在检测到全局变量 Vue 时会自动调用。但在模块环境中，仍需显性安装。  

```
import Vue from 'vue'
import VueRouter from 'vue-router'

Vue.use(VueRouter)
```

#### 



